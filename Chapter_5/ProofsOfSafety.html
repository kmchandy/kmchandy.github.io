<!DOCTYPE html>
<html lang="en">
<title>ProofsOfSafety</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://www.w3schools.com/lib/w3-theme-black.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
html,body,h1,h2,h3,h4,h5,h6 {font-family: "Roboto", sans-serif;}
.w3-sidebar {
  z-index: 3;
  width: 250px;
  top: 43px;
  bottom: 0;
  height: inherit;
}
</style>
<body>

<!-- Navbar -->
<div class="w3-top">
  <div class="w3-bar w3-theme w3-top w3-left-align w3-large">
    <a class="w3-bar-item w3-button w3-right w3-hide-large w3-hover-white w3-large w3-theme-l1" href="javascript:void(0)" onclick="w3_open()"><i class="fa fa-bars"></i></a>
    <a href="../index.html" class="w3-bar-item w3-button w3-hide-small
    w3-hover-white">About the Course</a>
    <a href="../table_of_contents.html" class="w3-bar-item w3-button w3-hide-small
    w3-hover-white">Table of Contents</a>
    <a href="../cross_reference.html" class="w3-bar-item w3-button w3-hide-small w3-hover-white">Index</a>
  </div>
  </div>
 

<!-- Sidebar -->
<nav class="w3-sidebar w3-bar-block w3-collapse w3-large w3-theme-l5 w3-animate-left" id="mySidebar">
  <a href="javascript:void(0)" onclick="w3_close()" class="w3-right w3-xlarge w3-padding-large w3-hover-black w3-hide-large" title="Close Menu">
    <i class="fa fa-remove"></i>
  </a>

  <!-------------------------->
  <h3 class="w3-bar-item"><b>An Introduction to Distributed
  Algorithms</h3>
  
  <a class="w3-bar-item w3-button w3-hover-black"
  href="Overview.html">Chapter: Common Proof Patterns</a>
  
  <a class="w3-bar-item w3-button w3-hover-black"
  href="ProofsOfSafety.html">How to Prove Safety</a>

  <a class="w3-bar-item w3-button w3-hover-black"
  href="ProofsOfProgress.html">How to Prove Progresss</a>

  <a class="w3-bar-item w3-button w3-hover-black"
  href="ProofPattern.html">Proof Pattern</a>

  <a class="w3-bar-item w3-button w3-hover-black"
  href="Examples.html">Examples</a>

  <a class="w3-bar-item w3-button w3-hover-black"
  href="SelfTest.html">Self Test</a>

  <a class="w3-bar-item w3-button w3-hover-black"
  href="../Chapter_6/Overview.html">
  Next Chapter: Agents</a> 
  
  <a class="w3-bar-item w3-button w3-hover-black"
  href="../Chapter_4/Overview.html">Previous Chapter:
  State Transition Systems</a>
  
</nav>


<!-- Overlay effect when opening sidebar on small screens -->
<div class="w3-overlay w3-hide-large" onclick="w3_close()" style="cursor:pointer" title="close side menu" id="myOverlay"></div>

<!-- Main content: shift it to the right by 250 pixels when the sidebar is visible -->
<div class="w3-main" style="margin-left:250px">
  
<script id="MathJax-script" async
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
  
  <div class="w3-row w3-padding-64">
  <div class="w3-twothird w3-container">

    
    <!------------------------------------------------------->
    <h1 class="w3-text-teal">How to Prove Safety</h1>
    <p>
    This module describes the methods that we often use to prove
    safety. An example is given at the end of the module.
    </p>

    <h3 class="w3-text-teal">The Key Safety Definition</h3>
    As we discussed in <a href="Model.html">the module on the model of
    a system</a>, \(P \rightarrow Q\) holds exactly when <i>all</i>
    actions of the system  that are initiated in a state in which
    \(P\) holds terminate in a state in which \(Q\) holds.
    </p>
    <p>
    Any action \(c\) in the set \(A\) of actions may be executed in
    any state. The Hoare triple \(\{P\} c \{Q\}\) specifies that if
    command \(c\) is executed in a state in which \(P\) holds then
    \(Q\) holds when the command terminates. Therefore:
    
    <h4 class="w3-text-teal">
    \(
    P \rightarrow Q \quad \equiv \quad \forall c \in A: \{P\} c \{Q\}
    \)
    </h4>
    
    
    <h3 class="w3-text-teal">Proofs of Safety</h3>
    A common specification of safety is that all trajectories remain
    in safe states. 
    Let \(safe\) be the predicate that defines safe
    states and \(init\) be the predicate that defines initial states.
    This safety specification is that \(safe\) holds in all states in
    all paths that start in states in which \(init\) holds.
    </p>

    <p>
    \(
    init \stackrel{*}{\rightarrow} safe
    \)
    </p>

    <p>
    We use the formula below to prove \(P \stackrel{*}{\rightarrow} Q\) for
    arbitrary \(P\) and \(Q\).
    </p>
    

    <h4 class="w3-text-teal">Safety Theorems</h4>
    <h5  class="w3-text-teal">
    \(
    stable(R) \wedge [P \Rightarrow R] \quad
    \Rightarrow \quad (P \stackrel{*}{\rightarrow} R)
    \)
    </h5>

    <p>
    Proof:
    </p>
    <p>
    \(
    stable(R) \; \equiv \; R \stackrel{*}{\rightarrow} R
    \)
    </p>
    <p>
    Strengthen the left-hand side to get the result.
    </p>

    <h5  class="w3-text-teal">
    \(
    stable(R) \wedge [R \Rightarrow Q] \quad
    \Rightarrow \quad (R \stackrel{*}{\rightarrow} Q)
    \)
</h5>
<p>
The proof is similar to that of the previous proof.
</p>


<p class="w3-text-teal">Intuition underlying the Proof</p>
The intuition of the proof is captured in the figure which depicts the
case where: \([P \Rightarrow R] \wedge stable(R) \wedge [R \Rightarrow
Q]\).
</p>
<figure>
  <img src="PinAlwaysQ.jpg" alt="Fig1" style="width:60%">
</figure>

<h3 class="w3-text-teal">Invariants</h3>
The standard way to prove:
</p>


<p>
    \(
    init \stackrel{*}{\rightarrow} safe
    \)
</p>

<p>
is to find a stable predicate \(I\) such that:
</p>

<p>
\(
[init \Rightarrow I] \wedge [I \Rightarrow safe]
\)
</p>

<p>
Such a predicate \(I\) is called an <i>invariant</i> of the
system. The figure above depicts an invariant where \(Q = safe\),
\(P = init\) and \(R\) is the invariant.
</p>


<h1 style="color:red;">Example</h1>
We use the example of the <i>earliest meeting time</i> given in the
module
<a href="RunningExample.html">A Running Example</a>.
</p>

<h4 style="color:red;">Example of \(P \rightarrow Q\)</h4>

Next, let's prove \((t = T \leq M) \; \rightarrow \; (T \leq t \leq M)\), as an
example of proofs of the forrm  \(P \rightarrow Q\).
</p>

<p>
We have to prove, for all actions \(d\) of the system:
<p>
\(
\{t = T \leq M\} \; d \; \{T \leq t \leq M\}
\)
</p>

<p>
So, we have to prove, the above Hoare triple for \(a_{i,j}\) for all
\(i, j\), and for \(b_{j}\) and \(c_{j}\) for all \(j\).

<p>
The specification for \(a_{i,j}\) is:
</p>
<p>
\(
\{ t=T \} \; a_{i,j} \; \{\; t_{j} = max(T_{i}, T_{j}) \; \}
\)
</p>

<p>
If \(T_{i} \leq m\) and
\(T_{j} \leq m\) then \(max(T_{i}, T_{j}) \leq m\).
</p>

<p>
Therefore
</p>
<p>
\(
\{t = T \leq M\} \; a_{i,j} \; \{T \leq t \leq M\}
\)
</p>


<p>
The proofs for actions \(b_{j}\) and \(c_{j}\) are similar.
</p>


<h4 style="color:red;"> Example of stable</h4>
From \((t = T \leq M) \; \rightarrow \; (T \leq t \leq M)\) we get:
<p>
\(
(t \leq M) \; \rightarrow \; (t \leq M)
\)
</p>
<p>
and therefore \(stable(t \leq M)\) and \(stable(t = M)\).
</p>



<h4 style="color:red;"> Example of \(P \stackrel{*}{\rightarrow} Q\)</h4>
Next let's use the safety theorem to prove that 
    \(
    (t = \emptyset) \; \stackrel{*}{\rightarrow} \; (t \leq M)
    \)
as an example of a proof of \(P \stackrel{*}{\rightarrow} Q\).
</p>

<p>
We showed \(stable(t \leq M)\).
</p>
<p>
From the definition:
\(
(t = \emptyset) \; \Rightarrow \; (t \leq M)
\).
</p>
<p>
Using the safety theorem with:
</p>
<p>
\(P \equiv (t = \emptyset)\),  \(R \equiv
(t \leq M)\), and \(Q \equiv (t \leq M)\)
gives the result.
</p>

 
    
<!---------------------------------------->
  <footer id="myFooter">

    <div class="w3-container w3-theme-l1">
      <h4>An Introduction to Distributed Algorithms by K. Mani Chandy,
      <br>
      Simon Ramo Professor, Emeritus, California Institute of Technology</h4>
    </div>
  </footer>


<!-- END MAIN -->
</div>

<script>
// Get the Sidebar
var mySidebar = document.getElementById("mySidebar");

// Get the DIV with overlay effect
var overlayBg = document.getElementById("myOverlay");

// Toggle between showing and hiding the sidebar, and add overlay effect
function w3_open() {
  if (mySidebar.style.display === 'block') {
    mySidebar.style.display = 'none';
    overlayBg.style.display = "none";
  } else {
    mySidebar.style.display = 'block';
    overlayBg.style.display = "block";
  }
}

// Close the sidebar with the close button
function w3_close() {
  mySidebar.style.display = "none";
  overlayBg.style.display = "none";
}
</script>

</body>
</html>
