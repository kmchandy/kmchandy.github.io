<!DOCTYPE html>
<html lang="en">
<title>Safety</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://www.w3schools.com/lib/w3-theme-black.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
html,body,h1,h2,h3,h4,h5,h6 {font-family: "Roboto", sans-serif;}
.w3-sidebar {
  z-index: 3;
  width: 250px;
  top: 43px;
  bottom: 0;
  height: inherit;
}
</style>

<body>

<!-- Navbar -->
<div class="w3-top">
  <div class="w3-bar w3-theme w3-top w3-left-align w3-large">
    <a class="w3-bar-item w3-button w3-right w3-hide-large w3-hover-white w3-large w3-theme-l1" href="javascript:void(0)" onclick="w3_open()"><i class="fa fa-bars"></i></a>
    <a href="../index.html" class="w3-bar-item w3-button w3-hide-small
    w3-hover-white">About the Course</a>
    <a href="../table_of_contents.html" class="w3-bar-item w3-button w3-hide-small
    w3-hover-white">Table of Contents</a>
    <a href="../cross_reference.html" class="w3-bar-item w3-button w3-hide-small w3-hover-white">Index</a>
  </div>
  </div>
 

<!-- Sidebar -->
<nav class="w3-sidebar w3-bar-block w3-collapse w3-large w3-theme-l5 w3-animate-left" id="mySidebar">
  <a href="javascript:void(0)" onclick="w3_close()" class="w3-right w3-xlarge w3-padding-large w3-hover-black w3-hide-large" title="Close Menu">
    <i class="fa fa-remove"></i>
  </a>
  
  <h3 class="w3-bar-item"><b>An Introduction to Distributed
  Algorithms</h3>
  <a class="w3-bar-item w3-button w3-hover-black"
  href="Safety.html">Chapter: Safety</a>
  <a class="w3-bar-item w3-button w3-hover-black" href="GraphRunningExample.html">More Examples</a>
  <a class="w3-bar-item w3-button w3-hover-black" href="GraphPicturesOfBasicConcepts.html">More Diagrams</a>
  <a class="w3-bar-item w3-button w3-hover-black" href="GraphExampleSafeFileAccess.html">System Example</a>
  <a class="w3-bar-item w3-button w3-hover-black" href="GraphSelfTest.html">Self Test</a>
  <a class="w3-bar-item w3-button w3-hover-black"
  href="../Chapter_2/Progress.html">Next Chapter: Progress</a> 
</nav>

<!-- Overlay effect when opening sidebar on small screens -->
<div class="w3-overlay w3-hide-large" onclick="w3_close()" style="cursor:pointer" title="close side menu" id="myOverlay"></div>

<!-- Main content: shift it to the right by 250 pixels when the sidebar is visible -->
<div class="w3-main" style="margin-left:250px">
  
<script id="MathJax-script" async
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
  
  <div class="w3-row w3-padding-64">
  <div class="w3-twothird w3-container">
    
    <h1 class="w3-text-teal">Safety</h1>

    <p>
    This chapter introduces all the concepts that we use in this
    course to prove that systems are safe. These concepts are
    described in terms of <a
    href="https://en.wikipedia.org/wiki/Directed_graph">
    directed graphs</a>.
    This chapter consists of this module and supporting modules
    containing diagrams and self tests.
    </p>

    <!---------------------------------------------------------->
    <h2 class="w3-text-teal">Representing a System by a Graph</h2>
  We represent the states and state transitions of a system by a
  <a href="https://en.wikipedia.org/wiki/Directed_graph">directed graph</a>
  in which vertices represent states and edges
  represent  transitions. A system trajectory is a path through the
    graph.
  When we design algorithms we will prove that the system always
    remains in safe states.
    </p>

    <h4 style="color:blue;">
    
		      We prove that a system is
		      safe by proving that all
		      paths from vertices representing initial states
		      only visit vertices representing safe states.
    </h4>

    <p>
    Of course, we require that initial states are safe.
    </p>

    

		      <h2 id=Graph2 class="w3-text-teal">Graphs</h2>
		      Let \(G = (V, \rightarrow) \) be a <a
		      href="https://en.wikipedia.org/wiki/Directed_graph">
		      <b>directed graph </b> </a> where \(V\) is the
		      set of vertices and \(\rightarrow \) is a binary
		      relation on vertices that specifies the set of
		      edges: 
		      \(v \rightarrow w\) indicates that there
		      is an edge from vertex \(v\) to vertex \(w\) in
		      the graph.
      </p>

      <a name="Example"></a>
    <h3 class="w3-text-teal">Example</h3>
    
<figure>
  <img src="GraphExample.jpg" alt="Fig2" style="width:50%">>
  <figcaption>Fig.1 - An Example of a Graph</figcaption>
</figure>

		      <p style="color:red;"><b>Examples of vertices</b></p>
\( V = \{0, 1, 2, 3, 4, 5, 6, 7 \} \)

		     

<p style="color:red;"><b>Examples of edges</b></p>
\( 0 \rightarrow 1, \; 0 \rightarrow 2, \;  0 \rightarrow 3, \; 0 \rightarrow 7, \;
\; 1 \rightarrow 7, \; 2 \rightarrow 4,\)
\(2 \rightarrow 5 , \; 3 \rightarrow 5, \;  3 \rightarrow 6, \; 4 \rightarrow 5, \; 5
\rightarrow 4, \; 6 \rightarrow 6, \; 7 \rightarrow 6\)
</p>



		      <h3 class="w3-text-teal">Paths</h3>
		      We use the notation
		      \(\stackrel{*}{\rightarrow}\)
		      to denote the transitive closure of
		      \(\rightarrow\).
		      So, \(v \stackrel{*}{\rightarrow} w\) holds exactly
		      when there exists a path from \(v\) to \(w\) in
the graph. We assume that there exists a path, with zero hops, from each
vertex to itself.
\(\forall v: \; v \rightarrow v \)

<p style="color:red;"><b>Example of paths</b></p>
\(
1 \stackrel{*}{\rightarrow} 1, \; 1 \stackrel{*}{\rightarrow} 7, \;
7 \stackrel{*}{\rightarrow} 7, \; 7 \stackrel{*}{\rightarrow} 6, 
  \; 1 \stackrel{*}{\rightarrow} 6,
  \)


		      <h4 class="w3-text-teal" id=Graph3> Convention</h4>
		      We use upper case \(P, Q, R, X, Y\) to refer to sets of vertices,
		      and lower case \(u, v, w \) to  refer to individual
		      vertices.
		      All formulae containing these terms are
implicitly universally qualified.
</p>

<h3 class="w3-text-teal">Relations between Vertex Sets</h3>
<p class="w3-text-teal">\(P \rightarrow Q\)</p>
We extend the relation \(\rightarrow\)
to sets of vertices as follows.
      \(P \rightarrow Q\) holds exactly when every edge from every vertex in
\(P\) ends at a vertex in \(Q\).
</p>

<p>
\(
\forall v \in P: (v \rightarrow w) \; \Rightarrow \; (w \in Q)
\)
</p>


<p style="color:red;"><b>Example of \(P \rightarrow Q\)</b></p>
\(
\{2, 3\} \rightarrow \{4, 5, 6\}
\)
</p>

<p>
  Explanation: All outgoing edges from vertices \(2\) and \(3\)
terminate at vertices in \(\{4, 5, 6\}\).
</p>

<p class="w3-text-teal">\(P \stackrel{*}{\rightarrow} Q\)</p>
<p>
We extend the relation \(\stackrel{*}{\rightarrow}\)
to sets of vertices in the same way.

\(P \stackrel{*}{\rightarrow} Q\) holds exactly when every path
from every vertex in \(P\) ends at a vertex in \(Q\). 
</p>
<p>
\(
\forall v \in P: (v \stackrel{*}{\rightarrow} w) \; \Rightarrow \; (w \in Q)
\)
</p>

<p>
Therefore
\(P \stackrel{*}{\rightarrow} Q\) holds exactly when all paths from
\(P\) lie entirely in \(Q\), i.e., all vertices on all paths from
\(P\) are in \(Q\).
</p>

<p style="color:red;"><b>Example of \(P \stackrel{*}{\rightarrow}
Q\)</b></p>
<p>
\(
\{1, 2\} \rightarrow \{1, 2, 4, 5, 6, 7\}
\)
</p>

<p>
  Explanation: There is a zero-hop path from vertex \(1\) back to
itself, and from vertex \(2\) back to itself. There are paths from
\(2\) to \(4\) and \(5\), and there are paths from \(1\) to \(6\) and
\(7\). There are no paths from \(1\) or \(2\) to \(0\) or \(3\).

<h2 class="w3-text-teal">Safety Proof Obligation</h2>
Let \(init\) be the set of initial vertices and \(safe\) be the set of
safe vertices.
</p>
<h4 style="color:blue;">To prove that a system is safe, we must show
that:
<br>
\(init \stackrel{*}{\rightarrow} safe\)
<h4>




<h2 class="w3-text-teal">Stable</h2>
<b>stable</b> is a function from sets of vertices to the Booleans.
\(stable(P)\) holds exactly when every edge from a vertex in \(P\) is
to a vertex in \(P\).
</p>

<p>
\(
stable(P) \; \equiv \; (P \rightarrow P)
\)
</p>

<p style="color:red;"><b>Example of Stable</b></p>
\(
\textit{stable}(\{4, 5\})
\)
<br>
Explanation: Every outgoing edge from vertex \(4\) is to vertex \(5\)
which is in set \(\{4, 5\}\), and every 
outgoing edge from vertex \(5\) is to vertex \(4\)
which is in set \(\{4, 5\}\).
</p>

<p>
From the definition, \(stable(P)\) holds when all paths from vertices
in \(P\) are in \(P\).
</p>

<p>
\(
stable(P) \; \equiv \; (P \stackrel{*}{\rightarrow} P)
\)
</p>

<!--------------------------------------------------->
<h3 class="w3-text-teal">Next and Always</h3>

\(N\), read as "<b>next</b>", and \(A\), read as "<b>always</b>" are
functions from vertex sets to vertex sets.
</p>

<p>
      \(v\) is in \(N(Y)\) exactly when every single hop from \(v\)
      ends at a vertex in \(Y\). 
<br>
\(v\) is in \(A(Y)\) exactly when every path from \(v\) ends at 
a vertex in \(Y\).
</p>
      
      <p>
      \(
      v \in N(Y) \; \equiv \; \forall w: (v \rightarrow w) \Rightarrow
      ( w \in Y) 
      \)
<br>
      \(
      v \in A(Y) \; \equiv \;
      \forall w:  (v \stackrel{*}{\rightarrow} w) \Rightarrow
      ( w \in Y) 
      \)
</p>

<p style="color:red;"><b>Example of Next</b></p>
\(
  N(\{0, 1, 2, 3\}) = \{0\}
  \)
  <br>
  Explanation: Every edge from \(0\) terminates at vertices in \(\{0,
  1, 2, 3\}\), and so \(0\) is in \(N(\{0, 1, 2, 3\})\).
  Every vertex \(v\)
  other than \(0\) has an outgoing edge that terminates at a vertex outside \(\{0,
  1, 2, 3\}\), 
  and so these vertices are not 
in \(N(\{0, 1, 2, 3\}\).


<p style="color:red;"><b>Example of Always</b></p>

  \(
  A(\{0, 1, 3, 6, 7\}) = \{1, 6, 7\}
  \)
  <br>
  Explanation: The only edge from vertex \(6\) is \(6 \rightarrow
  6\). So, all paths from vertex \(6\) visit only vertex \(6\) which
  is in the set \(\{0, 1, 3, 6, 7\}\). Therefore \(6\) is in
  \(A(\{0, 1, 3, 6, 7\})\).
  <p>
  The only edge from vertex \(7\) is 
  \(7 \rightarrow 6\).
  So, all paths from vertex \(7\) visit only vertices \(6\) and \(7\),
  both of which
  are in the set \(\{0, 1, 3, 6, 7\}\).
  Therefore \(7\) is in
  \(A(\{0, 1, 3, 6, 7\})\).
  By the same argument, all paths from vertex \(1\) visit only
  vertices \(1\), \(6\) and \(7\), all of which are in set \(\{0, 1,
  3, 6, 7\}\), and so \(1\) is in \(A(\{0, 1, 3, 6, 7\})\).
  <p>
  Why isn't \(0\) in \(A(\{0, 1, 3, 6, 7\})\)? Because there is a path
  from \(0\) to \(2\) which is not in \(\{0, 1, 3, 6, 7\}\).
  Similarly \(3\) is not in \(A(\{0, 1, 3, 6, 7\})\) because of paths
  from \(3\) to \(5\).
  <p>
  Every vertex \(v\) that is not in \(\{0, 1, 3, 6, 7\}\) has a path
  from \(v\) to \(v\), and so these vertices are not in \(A(\{0, 1, 3,
  6, 7\})\).

<p>
The safety proof obligation, in terms of <i>always</i> is:
</p>
<p>
\(init \subseteq A(safe)\)
</p>

<h3 class="w3-text-teal">Relations or Functions</h3>
You can use either \(\rightarrow\) or <i>next</i>, because:
</p>
<p>
\(
P \rightarrow Q \; \equiv \; [P \subseteq N(Q)]
\)
</p>
Similarly, you can use either \(\stackrel{*}{\rightarrow}\) or <i>always</i>, because:
</p>
<p>
\(
P \stackrel{*}{\rightarrow} Q \; \equiv \; [P \subseteq A(Q)]
\)
</p>
<p>
Whether you use the relations \(\rightarrow\) and
\(\stackrel{*}{\rightarrow}\) or the functions \(N\) and \(A\) is a
matter of personal preference. In this course we use \(\rightarrow\) and
\(\stackrel{*}{\rightarrow}\).
</p>


<!------------------------------------------------->
<h2 class="w3-text-teal">Summary</h2>
This chapter describes all the concepts that we use to prove that
systems are safe. These concepts are \(\rightarrow\) and
\(\stackrel{*}{\rightarrow}\)  (or equivalently
<i>next</i> and <i>always</i>).
</p>


  <footer id="myFooter">

    <div class="w3-container w3-theme-l1">
      <h4>An Introduction to Distributed Algorithms by K. Mani Chandy,
      <br>
      Simon Ramo Professor, Emeritus, California Institute of Technology</h4>
    </div>
  </footer>


<!-- END MAIN -->
</div>

<script>
// Get the Sidebar
var mySidebar = document.getElementById("mySidebar");

// Get the DIV with overlay effect
var overlayBg = document.getElementById("myOverlay");

// Toggle between showing and hiding the sidebar, and add overlay effect
function w3_open() {
  if (mySidebar.style.display === 'block') {
    mySidebar.style.display = 'none';
    overlayBg.style.display = "none";
  } else {
    mySidebar.style.display = 'block';
    overlayBg.style.display = "block";
  }
}

// Close the sidebar with the close button
function w3_close() {
  mySidebar.style.display = "none";
  overlayBg.style.display = "none";
}
</script>

</body>
</html>
