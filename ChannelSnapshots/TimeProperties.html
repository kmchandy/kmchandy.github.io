<title>ChannelSnapshots/PartiallySynchronousAlgorithms.html</title>
<!------------- Start Heading -------------------------------->
<!DOCTYPE html>

<html lang="en">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="stylesheet"
href="https://www.w3schools.com/w3css/4/w3.css">

<link rel="stylesheet"
href="https://fonts.googleapis.com/css?family=Roboto">

<link rel="stylesheet"
href="https://www.w3schools.com/lib/w3-theme-blue.css">

<link rel="stylesheet"
href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<style>
html,body,h1,h2,h3,h4,h5,h6 {font-family: "Roboto", sans-serif;}
.w3-sidebar {
  z-index: 3;
  width: 250px;
  top: 43px;
  bottom: 0;
  height: inherit;
}
/* Thick blue border */
hr.new2 {
  border: 2px solid blue;
}
/* blue border */
hr.new1 {
  border: 2px solid blue;
}
</style>


<body>


<div class="w3-top">
<div class="w3-bar w3-theme w3-top w3-left-align w3-large">
  
  <a class="w3-bar-item w3-button w3-right w3-hide-large
  w3-hover-white w3-large w3-theme-l1"
  href="javascript:void(0)"
  onclick="w3_open()">
  <i class="fa fa-bars"></i></a>

  <a href="../index.html"
  class="w3-bar-item w3-button w3-hide-small w3-hover-white">
  Distributed Algorithms
  </a>

  <a href="../table_of_contents.html"
  class="w3-bar-item w3-button w3-hide-small w3-hover-white">
  Contents
  </a>

  <a href="../cross_reference.html"
  class="w3-bar-item w3-button w3-hide-small w3-hover-white">
  Index
  </a>
    
  </div>
  </div>
  
  <script id="MathJax-script" async
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
  
<div class="w3-row w3-padding-64">
<div class="w3-twothird w3-container">



  <title>ChannelSnapshots/PartiallySynchronousAlgorithms.html</title>

    <!--------------------------------------------------------->
    <h2 class="w3-text-teal">Timelines as Sequences of Rounds</h2>


  <p class="w3-text-green">
  This page uses material from
  <a
  href="https://kmchandy.github.io/DISTRIBUTED_SYSTEM_MODELS/Timelines.html">
  Timelines.
  </a>
  </p>


  <!------------------------------------------------------------------->
  <h4 class="w3-text-red">
  <i>Central Ideas</i></h4>

  <p class="w3-text-red">
  (1) Systems in which messages may be lost. (2) Consistent cuts of
  timelines. (3) Timelines in which events occur in rounds.
  
  <p class="w3-text-red">
  
  We consider systems in which messages may be lost and we
  describe a framework that allows us to reason about distributed
  algorithms by analyzing timelines consisting of sequences of rounds
  where <i>all messages received in a round are sent in the same
  round.</i> 


  <h2 class="w3-text-teal">Rounds</h2>
  We consider systems in which messages may be lost.

  We assign a number \(R(e)\) to each event \(e\), and we say
  that <i>event \(e\) occurs in round \(R(e)\).</i>

  Round ids are similar, but not identical, to logical times.

  <h4 class="w3-text-teal">Rules for Assigning Rounds</h4>
  The following rules are used to assign a round to an event
  \(e\) at an agent \(A\).

  Let \(e'\) be the event immediately preceding \(e\) at \(A\). 

  <ol>
    <li>
    If a message is sent in an event in round \(r\) then the message is
    assigned a timestamp \(r\).
    </li>
    <li>
    If \(e\) is an event in which no message is received then \(R(e)\)
    is assigned any value such that \(R(e) \geq R(e')\).
    </li>
    <li>
    If \(e\) is an event in which a message with timestamp \(r\) is
    received,
    <ol>
      <li>
      If \(r < R(e')\) then the message is discarded i.e., treated
      as lost, and event \(e\) is removed from the causality graph
      because it does not change the state of the receiver.
      </li>
      <li>
      If \(r \geq R(e')\) then \(R(e) = r\), and the message is
      processed, and event \(e\) is in the causality graph.
      </li>
    </ol>
  </ol>
  A consequence of these rules is that <i>messages stay within a
    round.</i> 
  A message sent in round \(r\) is either discarded  -- treated as
  lost -- or received in round \(r\).
  And a message received (i.e. not discarded) in round \(r\) was
  sent in round \(r\).


  

  <h3 style="color:red;">Example: Timeline with Rounds</h3>
  The figure below shows a timeline with two agents \(A\) and
  \(B\). The sequence of events at agent \(A\) are marked \(A0, A1,
  A2, \ldots\) and events at \(B\) are marked similarly.
  <p>
  Round numbers are shown in green. For example events A0, A1, and A2
  are in round 0, while event A3 is in round 2, and events A4, A5 are
  in round 3.

  
  <h5 style="color:red;">Example: Timeline with Discarded Messages</h5>
  Messages that are discarded are shown as dashed blue
  lines. Discarded messages are marked as lost.
  
  Messages that are delivered are shown as red lines.

  <figure>
    <img src="../ChannelSnapshots/TimelinesNew/TimelinesNew.001.jpeg"
    alt="Fig1" style="width:100%"> 
    <figcaption>Fig. 1: Timelines with Rounds, and Messages Discarded
    and Delivered</figcaption>
  </figure>

  The message sent in event A0 has timestamp 0 because A0 is in round
  0.

  This message is received by agent B when B is in round 1. So, this
  message is discarded, and the event in which the message is received
  is removed from the causality graph.

  The removed event is shown as an empty circle.

  <p>
  The message sent in event B3 has timestamp 2. This message is
  received by agent A in event A3. The previous event, A2, on agent A
  is in round 0. So, A3 is placed in round 2.

<p>
Events in this timeline don't occur in increasing order of rounds.

For examples events B2, B3 in round 2 occur before event A2 in round 0.

  <h5 style="color:red;">Example: Timeline without Discarded Messages</h5>
  Figure 2 shows the same timeline as figure 1, but without showing
  discarded messages. 

  

  <figure>
    <img src="../ChannelSnapshots/TimelinesNew/TimelinesNew.002.jpeg"
    alt="Fig2" style="width:100%"> 
    <figcaption>Fig. 2: Timelines with Rounds, and only Delivered Messages
  </figure>

In this timeline, for every edge from \(e'\) to \(e\) in the causality
  graph: \(R(e') \leq R(e)\). Therefore, there exists a timeline, with
  the same causality graph, where events occur in rounds; see figure
  3. 

<h5 style="color:red;">Example: Timeline with same Causality Graph and
   Events in Order of Rounds</h5>
   <figure>
    <img src="../ChannelSnapshots/TimelinesNew/TimelinesNew.003.jpeg"
    alt="Fig3" style="width:100%"> 
    <figcaption>Fig. 3: Timeline as Sequence of Rounds
  </figure>
  In the timeline of figure 3, messages are received in the same round
    that they are sent.


  <!---------------------------------->
<h3 class="w3-text-teal">Theorem</h3>
Given any computation \(C\) of an algorithm in which messages may be lost,
where the algorithm follows the rules for assigning rounds, there
exists a computation:
<ol>
  <li>
  with the same causality graph as \(C\) and
  </li>
  <li>
  in which events in later rounds occur after events in earlier
  rounds, and
  </li>
  <li>
  messages sent in a round are received in the same round.
  </li>
</ol>

<h5 class="w3-text-teal">Proof</h5>

The rules for assigning rounds to events guarantees that for all edges
\((e', e)\) in the causality graph: \(R(e') \leq R(e)\).
Therefore, there exists a topological sort of the causality graph in
which \(e'\) precedes \(e\) in the sort if \(R(e') \leq R(e)\).
All topological sorts of a causality graph are computations.

So, there exists a computation with the same causality graph in which
events occur in rounds.

The rules for assigning rounds guarantees that messages sent in events
in round \(r\) are received in round \(r\).



  <h5 class="w3-text-teal">A Technique for Analyzing Algorithms in
Systems with Message Loss</h5>

We can simplify the analysis of algorithms in which messages may be
lost.

Instead of analyzing a given computation we analyze a computation with
the same causality graph, in which events occur in rounds and messages
stay within a round.

Analyzing a single round can be simpler than analyzing arbitrary
computations as we see in the consensus algorithm
  <a href="../Paxos/PaxosFinal.html">Paxos</a>

<h4 class="w3-text-red">
<i>Central Ideas: Review</i></h4>
<p class="w3-text-red">

The rules for assigning rounds enables us to prove properties of
algorithms in which messages are lost by proving properties of
computations that occur as sequences of rounds, where all messages
sent in a round are received in the same round.

<p class="w3-text-red">
<i>Concepts</i>:
Timelines -> causality graphs -> topological sorts -> rules for
assigning rounds -> computation as sequences of rounds.


<h4 class="w3-text-teal">Next</h4>
Next look at
<a href="../Paxos/ConsensusImpossible.html">consensus algorithms</a> and
<a href="../Paxos/PaxosFinal.html">Paxos</a>.
  
<!--Start Footer--------------------------------------->

    <hr class="new1">
      <p>K. Mani Chandy,
      Emeritus Simon Ramo Professor,
      California Institute of Technology</p>
    
</footer>
    


<!-- END MAIN -->




</body>
</html>
