<!DOCTYPE html>
<html lang="en">
<title>GlobalSnapshotApplications</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://www.w3schools.com/lib/w3-theme-black.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
html,body,h1,h2,h3,h4,h5,h6 {font-family: "Roboto", sans-serif;}
.w3-sidebar {
  z-index: 3;
  width: 250px;
  top: 43px;
  bottom: 0;
  height: inherit;
}
</style>
<body>


<!-- Navbar -->
<div class="w3-top">
  <div class="w3-bar w3-theme w3-top w3-left-align w3-large">
    <a class="w3-bar-item w3-button w3-right w3-hide-large w3-hover-white w3-large w3-theme-l1" href="javascript:void(0)" onclick="w3_open()"><i class="fa fa-bars"></i></a>
    <a href="../index.html" class="w3-bar-item w3-button w3-hide-small
    w3-hover-white">About the Course</a>
    <a href="../table_of_contents.html" class="w3-bar-item w3-button w3-hide-small
    w3-hover-white">Table of Contents</a>
    <a href="../cross_reference.html" class="w3-bar-item w3-button w3-hide-small w3-hover-white">Index</a>
  </div>
  </div>
 

<!-- Sidebar -->
<nav class="w3-sidebar w3-bar-block w3-collapse w3-large w3-theme-l5 w3-animate-left" id="mySidebar">
  <a href="javascript:void(0)" onclick="w3_close()" class="w3-right w3-xlarge w3-padding-large w3-hover-black w3-hide-large" title="Close Menu">
    <i class="fa fa-remove"></i>
  </a>

  <!-------------------------->
  <h3 class="w3-bar-item"><b>An Introduction to Distributed
  Algorithms</h3>
  
  <a class="w3-bar-item w3-button w3-hover-black"
  href="GlobalSnapshotApplications.html">Applications of Global Snapshots</a>

  <a class="w3-bar-item w3-button w3-hover-black"
  href="GlobalSnapshotApplicationsExample.html">Examples</a>

  <a class="w3-bar-item w3-button w3-hover-black"
  href="GlobalSnapshotApplicationsSelfTest.html">Self Test</a>

  <a class="w3-bar-item w3-button w3-hover-black"
  href="GlobalSnapshotApplicationsExercises.html">Exercises</a>

  <a class="w3-bar-item w3-button w3-hover-black"
  href="GlobalSnapshotApplications.html">Explorations</a>

  <a class="w3-bar-item w3-button w3-hover-black"
  href="../Channels/Channels.html">
  Next: Diffusing Computations</a> 
  
  <a class="w3-bar-item w3-button w3-hover-black"
  href="../ChannelSnapshots/ChannelSnapshots.html">Previous:
  Snapshots with Channels
  </a>
  
</nav>

<!-- Overlay effect when opening sidebar on small screens -->
<div class="w3-overlay w3-hide-large" onclick="w3_close()" style="cursor:pointer" title="close side menu" id="myOverlay"></div>

<!-- Main content: shift it to the right by 250 pixels when the sidebar is visible -->
<div class="w3-main" style="margin-left:250px">
  
<script id="MathJax-script" async
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
  
  <div class="w3-row w3-padding-64">
  <div class="w3-twothird w3-container">

    <!--------------------------------------------------------->
    <h1 class="w3-text-teal">Global Snapshot Applications</h1>
    This module presents only a couple of the many applications of
    global snapshots.

    <h2 class="w3-text-teal">Termination Detection</h2>
    
    <h3 class="w3-text-teal">The Problem</h3>
    
    A system consists of a set of agents and a set of message-passing
    channels. All the shared variables are channels. The system and its
    agent diagram are described in
    <a href="../Channels/Channels.html">the module on message-passing
    channels.</a>

    <p>
    An agent is either <i>idle</i> or <i>active</i>. An idle agent
    remains idle until it receives a message. An idle agent does not
    send messages. An active agent may send messages. An active agent
    may become idle at any point. An idle agent becomes active when it
    receives a message.
    Initially all agents are active and all channels are empty.

    <p>
    A <i>terminated</i> state of the system is one in which all agents
    are idle and all channels are empty. <i>terminated</i> is stable:
    a system in a terminated state remains terminated thereafter. A
    system may or may not enter a terminated state.

    Our task is to develop an algorithm that detects that a system has
    entered a terminated state.

    
    <h3 class="w3-text-teal">An Algorithm</h3>
    An agent that sends messages along a channel \(C\) maintains
    a local variable, \(C_{s}\), which is the number of
    messages that the agent sent along \(C\).
    An agent that receives messages along a channel \(C\) maintains
    a local variable, \(C_{r}\), which is the number of
    messages that the agent received along \(C\).
    Initially all the agents' local
    variables, \(C_{s}\) and  \(C_{r}\), are \(0\).

    <figure>
    <img src="GlobalSnapshotApplications_1.jpg" alt="Fig1" style="width:100%">
    <figcaption>Fig.1: Local Variables in Agents</figcaption>
    </figure>
    
    <p>
    The figure above shows two agents, \(A\) and \(B\), and a single
    channel \(C\) directed from \(A\) to \(B\). Agent \(A\) has a
    local variable \(C_{s}\) which is the number of messages that
    \(A\) has sent along \(C\). Agent \(B\) has a
    local variable \(C_{r}\) which is the number of messages that
\(B\) has received along \(C\).

<p>
The figure below shows a point at which \(A\) has sent 4 messages
\(m_{0}, m_{1}, m_{2}, m_{3}\), and \(A\) has received the first 2
messages \(m_{0}, m_{1}\). At this point \(C_{s}=4, C_{r}=2\) and
messages \(m_{2}, m_{3}\) are in transit along the channel.

    <figure>
    <img src="GlobalSnapshotApplications_2.jpg" alt="Fig2" style="width:100%">
    <figcaption>Fig.2: Example of local variables at some point</figcaption>
    </figure>



    <p>
    The algorithm uses an agent, which is not part of the system, to
    carry out the detection. We call this agent <i>the
    detector</i>. 

    <p>
    When an agent transits from active to idle it sends a message to
    the detector containing copies of its local variables, \(C_{s}\)
    for every outgoing channel of the agent, and \(C_{r}\) for every
    incoming channel of the agent. 

<p>
The detector has its own local variables \(C_{s}\) and \(C_{r}\) for every
channel \(C\) in the system.
Initially the values of these local variables are 0.
When a detector gets a message from an
agent it sets the values of its local variables \(C_{s}\) and \(C_{r}\) to the
values of \(C_{s}\) and \(C_{r}\) in the message.

<h2 style="color:red;">Example</h2>

<figure>
    <img src="GlobalSnapshotApplications_3.jpg" alt="Fig3" style="width:100%">
    <figcaption>Fig.3: Example of local variables at a point</figcaption>
</figure>


<p>
The figure above shows an example of possible values of variables at
some point. At this point, agent \(A\) has been continuously active
and it has sent 3 messages along channel \(C\) and received 1 message along
channel \(D\). Agent \(A\) has not sent any messages to the detector
because \(A\) has not become idle.

<p>
Agent \(B\)
became idle after receiving 1 message along channel \(C\) and sending
2 messages along channel \(D\). When agent \(B\) became idle it sent a
message to the 
detector containing \(C_{r} = 1, D_{s} = 2\).
This message is in transit from \(B\) to the detector.

<p>
The local variables, \(C_{r}, C_{s}, D_{r}, D_{s}\), of the detector
are still their initial values because the detector hasn't received
messages.


<p>
The next figure shows a possible later point. Agent \(A\)
became idle after it sent 3 messages along channel \(C\) and received
2 messages along \(D\). When it became idle \(A\) sent a message to
the detector with the values \(C_{s} = 3, D_{r} = 2\). This message is
in transit from \(A\) to the detector.

<figure>
    <img src="GlobalSnapshotApplications_4.jpg" alt="Fig4" style="width:100%">
    <figcaption>Fig.4: Example of local variables at a later point</figcaption>
</figure>

The message that \(B\) sent to the detector with values \(C_{r} = 1,
D_{s} = 2\) was received by the detector. Upon receiving this message
the detector updated values of its own local variables to \(C_{r} = 1,
D_{s} = 2\).

<p>
Agent \(B\) receives a message that \(A\) sent, and becomes active
upon receiving the message.

<figure>
    <img src="GlobalSnapshotApplications_5.jpg" alt="Fig5" style="width:100%">
    <figcaption>Fig.5: Example of local variables at termination</figcaption>
</figure>

The above figure shows the following case. Agent \(B\) received all
the messages that \(A\) sent to it and then \(B\) became idle. When
\(B\) became idle it sent a message \(C_{r} = 3, D_{s} = 2\). The
message was received by the detector which updated its own local
variables. The detector also received the message that \(A\) sent to
it. At this point all agents are idle, all channels are empty, and the
values of the detector's local variables  satisfy the condition
\(C_{s} = C_{r}, D_{s} = D_{r}\).


<h3 class="w3-text-teal">Theorem</h3>
The computation has terminated if for all channels \(C\) of the
system, the local variables of the detector satisfy the condition:
<p>
\(
C_{s} = C_{r}
\)
</p>

<p class="w3-text-teal">Proof</p>
The proof using the concept of valid cuts is straightforward.

<p>







  <footer id="myFooter">

    <div class="w3-container w3-theme-l1">
      <h4>An Introduction to Distributed Algorithms by K. Mani Chandy,
      <br>
      Simon Ramo Professor, Emeritus, California Institute of Technology</h4>
    </div>
  </footer>


      


<!-- END MAIN -->
</div>

<script>
// Get the Sidebar
var mySidebar = document.getElementById("mySidebar");

// Get the DIV with overlay effect
var overlayBg = document.getElementById("myOverlay");

// Toggle between showing and hiding the sidebar, and add overlay effect
function w3_open() {
  if (mySidebar.style.display === 'block') {
    mySidebar.style.display = 'none';
    overlayBg.style.display = "none";
  } else {
    mySidebar.style.display = 'block';
    overlayBg.style.display = "block";
  }
}

// Close the sidebar with the close button
function w3_close() {
  mySidebar.style.display = "none";
  overlayBg.style.display = "none";
}
</script>

</body>
</html>

