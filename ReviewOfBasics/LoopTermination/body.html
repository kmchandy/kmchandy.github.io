<h1 class="w3-text-teal">Loop Termination: Variant Functions</h1>
<h4 class="w3-text-teal">
This module is a review of methods used to prove that executions of
loops terminate.
</h4>


We will prove that executions of loops terminate by using
<a href="https://en.wikipedia.org/wiki/Loop_variant">loop variants</a>.
We also use the term <i>variant function</i> for loop variant.
We will use variant functions to prove termination of distributed
systems. 

<p>
<i>A variant function is a function
from states of a system to a well-founded set.</i>

    A
    <a href="https://en.wikipedia.org/wiki/Well-founded_relation">
    well-founded set</a>
    is a set on which we can carry out proofs by
    induction. In this course we generally use well-founded sets that are
    integers or vectors of integers, and that are bounded below.
We compare vectors
<a href="https://en.wikipedia.org/wiki/Lexicographic_order">
lexicographically</a>. For example \((0, 2) < (1, 0)\).
    
    <p>
    Let \(f\) be a variant function. Then \(f = k\), for a constant
    \(k\) is a predicate. The extension of this predicate is the set
    of states \(s\) where \(f(s) = k\).

<hr class="new2">
    <h4 style="color:blue;">
    We prove that execution of a loop terminates by proving that the
    execution of any command whose guard evaluates to True reduces the
    value of a variant function \(f\). 
</h4>
<hr class="new2">
    <p>

     If the execution of any command with a True guard reduces
    \(f\) then every iteration
    reduces 
\(f\). Since \(f\) is bounded below, it cannot decrease forever.
Therefore, the computation terminates.



    <h4 class="w3-text-teal">Variant Functions and Hoare Triples</h4>
    Let \(I\) be an invariant
     of the loop, let the \(j\)-th guarded command have guard
    \(g_{j}\) and command \(c_{j}\), and let \(f\) be a variant function
    of the loop. We prove that the execution of any command with
    a True guard reduces the variant function by proving the
    following Hoare triple for all \(j\): 
<p>
\(\forall K: \quad
\{(f = k) \wedge I \wedge g_{j}\} \; c_{j} \; \{f < k\}
\)
<p>
Because \(I\) is an invariant it holds before every command is
    executed. Since \(c_{j}\) is executed only if \(g_{j}\) holds, we
    know that \(I \wedge g_{j}\) holds before \(c_{j}\) is
executed.
Execution of the command reduces the variant function from \(k\) to
    some smaller value.

<!-------------------------------------------------------------------->
    <h3 class="w3-text-teal">Variant Functions and Graphs</h3>
If an algorithm has a variant function \(f\) then all paths in
from initial vertices are cycle-free.
This is because every edge on the path is from a state with a higher
value of \(f\) to a state with a lower value.
The diagram below shows an acyclic graph with edges directed from
higher to lower \(f\) values.

<p>
A terminal state (vertex) is one without outgoing edges.
The existence of a variant function tells us that a terminal state is
reached from an initial state in a finite number of state transitions.


<figure>
  <img src="VariantFunction.jpg" alt="Fig1" style="width:80%">>
  <figcaption>Fig.1 - Variant Function decreases along every Edge</figcaption>
</figure>


<h4 class="w3-text-teal">
Self tests
</h4>
are given in
    <a href =
    "../ExamplesCorrectnessProofs/ExamplesCorrectnessProofs.html">
Examples of Correctness Proofs.
</a>

<h4 style="color:blue;">Review</h4>
<ol>
  <li>What is a variant function? What does lexicographical comparison
  of vectors of integers mean?</li>
  <li>Can a loop that executes forever have a variant function? Why not?</li>
</ol>.