    <h1 class="w3-text-teal">Self Test: Sorting</h1>

    
    <p>
    This module is a test of proving a do-od loop that sorts an array,
    \(X\), in place.
    <h4 class="w3-text-teal">Specification</h4>
    Let \(X^{init}\) be the initial value of \(X\) and \(X^{fini}\) be
    its value when the loop terminates. The specification of the loop
    is that execution of the loop terminates, and
    <ol>
      <li>
      \(X^{fini}\) is a permutation of \(X^{init}\), and
      </li>
      <li>
      \(X^{fini}\) is in ascending order.
      </li>
    </ol>
      
      

    <h2 class="w3-text-teal">Iterations</h2>
    Let \(X\) be an array of \(N\) numbers.
    Prove that the following loop satisfies the specification. 

    <pre>
for all i where 0 < i < N:
   X[i-1] > X[i]   ->    X[i-1], X[i] = X[i], X[i-1]
    </pre>
    
    The loop flips any adjacent pair that is out of order.


    <h2 class="w3-text-teal">Self Test: Proof of Correctness</h2>
    
    <h5 class="w3-text-teal">Test 1</h5>
    Give and prove an invariant of the loop, i.e, show that (1) the
    invariant holds initially and (2) if it holds before a command is
    executed then it holds after the command has executed.
    
    <h5 class="w3-text-teal">Test 2</h5>
    Prove that the loop terminates by giving a variant function for
    the loop. Show that (1) the function is bounded below, and (2)
    the function value can decrease only a finite number of times
    before the bound is reached, and (3) the execution of every guarded
    command with a true guard reduces the function.
    
    <h5 class="w3-text-teal">Test 3</h5>
    Prove that the specification holds upon termination of the
    loop, i.e. show that if the invariant holds and all the guards are
    false then the specification holds.

    <h3 class="w3-text-teal">Answers</h3>
    
    <h5 class="w3-text-teal">Answer 1</h5>
    The following is an invariant:
    <p>
    \(X\) is a permutation of \(X^{init}\).
    <p>
    The predicate holds initially and every state transition maintains
    it.
    
    <h5 class="w3-text-teal">Answer 2</h5>
    Define a variant function \(f(x)\) as the number of out-of-order
    pairs in \(x\):
    </p>
    <p>
    \(
    f(x) = |\{(i, j) | (i < j) \wedge (x[i] > x[j]\} |
    \)
    </p>
    The function has the following properties
    <ol>
      <li>
      It is bounded below.
      </li>
      <li>
      It can decrease only a finite number of times before the bound
      is reached because the function value is integer.
      </li>
      <li>
      The execution of any guarded command with a true guard decreases
      the function.
      </li>
    </ol>

    <h5 class="w3-text-teal">Answer 3</h5>
    Since the invariant holds
    \(X^{fini}\) is a permutation of \(X^{init}\).
    <p>
    Since all the guards evaluate to False at termination
    \(X^{fini}\) is in ascending order.
    <p>Therefore, if the invariant holds and all the guards evaluate
    to False then specification holds.